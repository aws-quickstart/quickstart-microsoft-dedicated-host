
== Post-deployment steps
=== Review License Manager Rules

Open the License Manager console at https://console.aws.amazon.com/license-manager/. 

In the left navigation pane, choose Customer managed licenses.

=== Review Host Resource Group
Now, lets review host resource group configuration.

Open the License Manager console at https://console.aws.amazon.com/license-manager/.

In the left navigation pane, choose Host resource groups.

== Provisioning ==

License Manager supports different deployment options to enforce the license rules.

* Launch Template and AMI
* CloudFormation
* AWS SDK's and tools
* AWS Service Catalog

Once the QuickStart deployment completes, navigate to the output section of the CloudFormation to record the following.

. GroupArn - This is the host resource group ARN
. LicenseArn - This is License Configuration ARN

image::../images/OutputARN.jpeg[additional_info]

In this deployment guide, we will show how to provision using Launch template, AWS Cli and CloudFormation. 
For other deployment methods , you may refer to AWS documentation. 

https://aws.amazon.com/blogs/mt/mechanisms-to-govern-license-usage-with-aws-license-manager/

=== Autoscaling ===

The QuickStart will create Launch Template and Autoscaling Group using two private subnets.
LaunchTemplateData is configured with 

        Placement:
          HostResourceGroupArn: < REPLACE WITH Host Resource Group ARN >
        LicenseSpecifications:
          - LicenseConfigurationArn: < REPLACE WITH LICENSE ARN >

Autoscaling is configured to take advantage of multiple availability zones represented by the private subnets configured within Autoscaling group.
Hence, autoscaling should be carefully considered depending on the workload you plan to run on dedicated host Infrastructure.

By default, the autoscaling value is set to 0. 
For example, if you set the desired, min and max to 2 during the deployment , you will launch the Instances evenly utilizing both availability zones.
This mean 2 dedicated hosts will be allocated for you per availability zone. 


=== AWS CLI ===

    aws ec2 run-instances \
    --instance-type c5.2xlarge \
    --image-id ami-0eXXXXXXXXXXXXef9  \
    --subnet-id subnet-0fdbxxxxxxxdcf \
    --license-specifications < REPLACE WITH LICENSE ARN > \
    --placement HostResourceGroupArn= < REPLACE WITH Host Resource Group ARN >



=== CloudFormation ===

To deploy using CloudFormation, ensure the resource properties include both HostResourceGroupArn & LicenseSpecifications

    Type: AWS::EC2::Instance
    Properties: 
    AvailabilityZone: String
    BlockDeviceMappings: 
        - BlockDeviceMapping
    HostResourceGroupArn: < REPLACE WITH Host Resource Group ARN >
    IamInstanceProfile: String
    ImageId: String
    InstanceType: String
    KeyName: String
    LaunchTemplate: 
        LaunchTemplateSpecification
    LicenseSpecifications: 
        - LicenseSpecification  < REPLACE WITH LICENSE ARN >
    SecurityGroupIds: 
        - String
    SecurityGroups: 
        - String
    SourceDestCheck: Boolean
    SsmAssociations: 
        - SsmAssociation
    SubnetId: String
    Tags: 
        - Tag
    Tenancy: String
    UserData: String
    Volumes: 
        - Volume

== Post-Launch Task ==
=== Validate License Manager dashboard ===

The Dashboard section of the AWS License Manager console provides graphs to track the license consumption associate with each license configuration. The dashboard also displays alerts resulting from license rule violations.

The following information is available in the graph for a license configuration:

. License configuration name

. License type

. Licenses consumed

. Number of licenses remaining

. Whether the rules are enforced

. Number of hosts for each tenancy type

*Track usage through built-in dashboard*

Open the License Manager console at https://console.aws.amazon.com/license-manager/. 

In the left navigation pane, choose Dashboard.




=== Run Windows updates

In order to ensure the deployed servers' operating systems and installed applications have the latest Microsoft updates, run Windows Update on each server.

Create an RDP session from the Remote Desktop Gateway server to BYOL Windows server.

Open the Settings application.

Open Update & Security.

Click Check for updates.

Install any updates and reboot if necessary.



